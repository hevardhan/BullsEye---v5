<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spectrum Audio Visualizer</title>
    <style>
        /* General Body Styling */
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
        }

        /* Canvas Styling */
        canvas {
            width: 100%;
            height: 100vh;
            background-image: url('bg.jpg'); /* Add your background image URL here */
            background-size: cover; /* Cover the entire background */
            background-position: center; /* Center the background image */
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        canvas.width = window.innerWidth * 0.9;

        navigator.mediaDevices.getUserMedia({ audio: true, video: false })
            .then(stream => {
                const audioContext = new AudioContext();
                const analyser = audioContext.createAnalyser();
                const source = audioContext.createMediaStreamSource(stream);

                source.connect(analyser);
                analyser.fftSize = 1024;

                const bufferLength = analyser.frequencyBinCount; // Use frequency bin count
                const dataArray = new Uint8Array(bufferLength);

                function draw() {
                    requestAnimationFrame(draw);

                    analyser.getByteFrequencyData(dataArray); // Get frequency data

                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    const barWidth = (canvas.width / bufferLength) * 5; // Adjusted bar width
                    let barHeight;
                    let x = 0;

                    for (let i = 0; i < bufferLength; i++) {
                        barHeight = dataArray[i];

                        // Create gradient based on the height of the bar
                        const gradient = ctx.createLinearGradient(x, canvas.height, x, canvas.height - barHeight);
                        gradient.addColorStop(0, '#ffffff'); // Bottom color
                        gradient.addColorStop(1, `hsl(${(barHeight / 255) * 360}, 100%, 50%)`); // Top color (hue based on height)

                        ctx.fillStyle = gradient; // Use gradient as fill color
                        ctx.fillRect(x, canvas.height - barHeight / 2, barWidth, barHeight / 2); // Draw bar

                        x += barWidth + 1; // Adjust spacing
                    }
                }

                draw();
            })
            .catch(err => {
                console.error('Error accessing audio input:', err);
            });
    </script>
</body>
</html>
